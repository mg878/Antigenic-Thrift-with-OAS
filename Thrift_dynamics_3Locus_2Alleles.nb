(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     26214,        620]
NotebookOptionsPosition[     25803,        603]
NotebookOutlinePosition[     26149,        618]
CellTagsIndexPosition[     26106,        615]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"loci", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alleles", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"L", "=", 
    SuperscriptBox["alleles", "loci"]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "total", " ", "number", " ", "of", " ", "antigenic", " ", "types", " ", 
    "present", " ", "in", " ", "the", " ", "population"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genotypes", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"alleles", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", 
         RowBox[{"alleles", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", 
         RowBox[{"alleles", "-", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"loci", "-", "1"}]}], "]"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{
   "defining", " ", "genotypes", " ", "as", " ", "strings", " ", "of", " ", 
    "0", "s", " ", "and", " ", "1", "s"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"cW", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     SuperscriptBox["alleles", "loci"]}], "]"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{"defining", " ", "the", " ", "contribution", " ", "to", " ", 
    SubscriptBox["w", "i"], 
    RowBox[{"(", "t", ")"}], " ", "from", " ", "any", " ", "strain", " ", 
    "that", " ", "shares", " ", "alleles", " ", "with", " ", "i"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "genotypes", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", "1"}], ",", 
      RowBox[{"j", "\[LessEqual]", 
       RowBox[{"Length", "[", "genotypes", "]"}]}], ",", 
      RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"m", "=", "1"}], ",", 
        RowBox[{"m", "\[LessEqual]", "loci"}], ",", 
        RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"genotypes", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "m"}], "\[RightDoubleBracket]"}], "\[Equal]", 
           RowBox[{"genotypes", "\[LeftDoubleBracket]", 
            RowBox[{"j", ",", "m"}], "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{
            RowBox[{
            "cW", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",", 
            RowBox[{
             RowBox[{"y", "[", "j", "]"}], "[", "t", "]"}]}], "]"}]}], 
         "]"}]}], "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", 
    RowBox[{"Length", "[", "genotypes", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cW", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
     "=", 
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{"cW", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cW", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
     "=", 
     RowBox[{"Total", "[", 
      RowBox[{"cW", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
      "]"}]}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.755030680404507*^9, 3.755030680644865*^9}, 
   3.756639854622999*^9, {3.7566398912571955`*^9, 3.7566399230405684`*^9}, 
   3.756639953850642*^9, {3.7566400346673746`*^9, 3.7566400458718495`*^9}, 
   3.7566402245263605`*^9, {3.7566423193647947`*^9, 3.756642320998618*^9}, {
   3.75664237929203*^9, 3.756642392424035*^9}, {3.7566469945168667`*^9, 
   3.7566470274809637`*^9}, 3.756647343116514*^9, 3.757267009783595*^9, {
   3.7572725827921214`*^9, 3.7572726155972157`*^9}, {3.7634603717645564`*^9, 
   3.7634604910474243`*^9}, {3.7634607165368557`*^9, 3.763460736143406*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"setting", " ", "the", " ", "values", " ", "for", " ", "each", " ", 
    RowBox[{"parameter", " ", "--"}], " ", "all", " ", "defined", " ", "in", 
    " ", "the", " ", "report"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "the", " ", "values", " ", "below", " ", "will", " ", "result", " ", "in", 
    " ", "a", " ", "chaotic", " ", "strain", " ", "structure"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Beta]", "=", " ", "40"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Mu]", "=", 
     RowBox[{"1", "/", "50"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Sigma]", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Gamma]", "=", "0.69"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalOmega]", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initFreqs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1.", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "4"}]]}], ",", 
       RowBox[{"2.", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "4"}]]}], ",", 
       RowBox[{"3.", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "4"}]]}], ",", 
       SuperscriptBox["4.10", 
        RowBox[{"-", "4"}]], ",", 
       SuperscriptBox["5.10", 
        RowBox[{"-", "4"}]], ",", 
       SuperscriptBox["6.10", 
        RowBox[{"-", "4"}]], ",", 
       RowBox[{"7.", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "4"}]]}], ",", 
       RowBox[{"8.", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "4"}]]}], ",", 
       RowBox[{"9.", "*", 
        SuperscriptBox["10", 
         RowBox[{"-", "4"}]]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "setting", " ", "the", " ", "initial", " ", "frequencies", " ", "of", " ",
      "strains"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stepSize", "=", 
     RowBox[{"1", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"maxStep", "=", 
     RowBox[{"60", "*", 
      SuperscriptBox["10", "4"]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tmax", "=", 
     RowBox[{"maxStep", "*", "stepSize"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqns1", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", "i", "]"}], "'"}], "[", "t", "]"}], "\[Equal]", 
         RowBox[{
          RowBox[{"\[Beta]", " ", 
           RowBox[{
            RowBox[{"y", "[", "i", "]"}], "[", "t", "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{
              RowBox[{"w", "[", "i", "]"}], "[", "t", "]"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "\[CapitalOmega]"}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"w", "[", "i", "]"}], "[", "t", "]"}], "-", 
                RowBox[{
                 RowBox[{"z", "[", "i", "]"}], "[", "t", "]"}]}], ")"}]}]}], 
            ")"}]}], "-", 
          RowBox[{"\[Mu]", " ", 
           RowBox[{
            RowBox[{"z", "[", "i", "]"}], "[", "t", "]"}]}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqns2", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"y", "[", "i", "]"}], "'"}], "[", "t", "]"}], "\[Equal]", 
         RowBox[{
          RowBox[{"\[Beta]", " ", 
           RowBox[{
            RowBox[{"y", "[", "i", "]"}], "[", "t", "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{
                RowBox[{"w", "[", "i", "]"}], "[", "t", "]"}]}], ")"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "\[Gamma]"}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"w", "[", "i", "]"}], "[", "t", "]"}], "-", 
                RowBox[{
                 RowBox[{"z", "[", "i", "]"}], "[", "t", "]"}]}], ")"}]}]}], 
            ")"}]}], "-", 
          RowBox[{"\[Sigma]", " ", 
           RowBox[{
            RowBox[{"y", "[", "i", "]"}], "[", "t", "]"}]}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqns3", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"w", "[", "i", "]"}], "'"}], "[", "t", "]"}], "\[Equal]", 
          RowBox[{
           RowBox[{"\[Beta]", " ", 
            RowBox[{"(", 
             RowBox[{
             "cW", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             ")"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{
               RowBox[{"w", "[", "i", "]"}], "[", "t", "]"}]}], ")"}]}], "-", 
           RowBox[{"\[Mu]", " ", 
            RowBox[{
             RowBox[{"w", "[", "i", "]"}], "[", "t", "]"}]}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "L"}], "}"}]}], "]"}], ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"z", "[", "i", "]"}], "[", "0", "]"}], "\[Equal]", "0"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "L"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"y", "[", "i", "]"}], "[", "0", "]"}], "\[Equal]", 
            RowBox[{
            "initFreqs", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "L"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"w", "[", "i", "]"}], "[", "0", "]"}], "\[Equal]", "0"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "L"}], "}"}]}], "]"}]}], "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqns", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"eqns1", ",", "eqns2", ",", "eqns3"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol", "=", 
     RowBox[{"NDSolve", "[", 
      RowBox[{"eqns", ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"y", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "L"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"z", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "L"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"w", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "L"}], "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "maxStep"}], "}"}], ",", 
       RowBox[{"MaxSteps", "\[Rule]", "maxStep"}], ",", 
       RowBox[{"MaxStepSize", "\[Rule]", "stepSize"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{"Ytraj", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"y", "[", "o", "]"}], "[", "t", "]"}], "/.", "sol"}], 
              "/.", 
              RowBox[{"t", "\[Rule]", "m"}]}], ")"}], "\[LeftDoubleBracket]", 
            "1", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "0", ",", 
           RowBox[{"tmax", "-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"o", ",", "1", ",", "L"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ztraj", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"z", "[", "o", "]"}], "[", "t", "]"}], "/.", "sol"}], 
              "/.", 
              RowBox[{"t", "\[Rule]", "m"}]}], ")"}], "\[LeftDoubleBracket]", 
            "1", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "0", ",", 
           RowBox[{"tmax", "-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"o", ",", "1", ",", "L"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Wtraj", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"w", "[", "o", "]"}], "[", "t", "]"}], "/.", "sol"}], 
              "/.", 
              RowBox[{"t", "\[Rule]", "m"}]}], ")"}], "\[LeftDoubleBracket]", 
            "1", "\[RightDoubleBracket]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "0", ",", 
           RowBox[{"tmax", "-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"o", ",", "1", ",", "L"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7551179995609026`*^9, 3.7551180055269084`*^9}, {
   3.755119283046256*^9, 3.755119284371668*^9}, {3.7551193465504246`*^9, 
   3.7551193761771774`*^9}, {3.7551202781325936`*^9, 3.7551203022192116`*^9}, 
   3.7551220232674665`*^9, {3.755129443231928*^9, 3.75512945322021*^9}, {
   3.755130250476*^9, 3.7551302729309807`*^9}, {3.755130466813898*^9, 
   3.7551305116280346`*^9}, {3.755130601047862*^9, 3.755130624916021*^9}, {
   3.7551790656783323`*^9, 3.755179079688858*^9}, 3.7551791690369205`*^9, {
   3.755179300810801*^9, 3.7551793136524534`*^9}, 3.7551794028628416`*^9, 
   3.7551795425223355`*^9, 3.7551799307100453`*^9, {3.7551820477440467`*^9, 
   3.7551820479046593`*^9}, 3.755182176351833*^9, 3.7551824481913548`*^9, 
   3.755183261327854*^9, {3.755184114546303*^9, 3.7551841176809206`*^9}, {
   3.755184205987685*^9, 3.7551842061233625`*^9}, 3.755184379500656*^9, {
   3.7551844129980993`*^9, 3.755184413181568*^9}, 3.755184464129299*^9, 
   3.75520366112185*^9, 3.755203695804082*^9, {3.7552037975067296`*^9, 
   3.755203850075127*^9}, {3.755205114921281*^9, 3.7552051192228203`*^9}, 
   3.755205251864997*^9, 3.7552053528557243`*^9, 3.7552053851144824`*^9, {
   3.7552055945583773`*^9, 3.7552055966198215`*^9}, {3.7552056327761555`*^9, 
   3.755205634699969*^9}, {3.755207077660098*^9, 3.75520708015343*^9}, {
   3.755207166328893*^9, 3.755207230727644*^9}, {3.7552074116686797`*^9, 
   3.755207438256563*^9}, {3.7552075329981575`*^9, 3.7552075729787436`*^9}, {
   3.7552077332480693`*^9, 3.755207735403349*^9}, {3.7552736278325033`*^9, 
   3.755273629455162*^9}, {3.75527367636569*^9, 3.7552736786635447`*^9}, {
   3.755273710685895*^9, 3.7552737122008424`*^9}, {3.755273749829196*^9, 
   3.755273777637861*^9}, {3.7552738254579115`*^9, 3.7552738594051123`*^9}, {
   3.7552970814170904`*^9, 3.75529708367601*^9}, {3.755297196023551*^9, 
   3.755297201646509*^9}, 3.7552972676110744`*^9, 3.755466106940469*^9, {
   3.7554661517516527`*^9, 3.7554661558985634`*^9}, {3.755466188308834*^9, 
   3.7554661903544025`*^9}, 3.7554672196699724`*^9, {3.755467254321292*^9, 
   3.755467259487473*^9}, {3.755467295280012*^9, 3.7554672973813915`*^9}, {
   3.7554673342587976`*^9, 3.7554673500495605`*^9}, {3.7554678334235*^9, 
   3.755467883821701*^9}, {3.755468188710763*^9, 3.7554682261077356`*^9}, 
   3.7554682909939747`*^9, {3.755473269858094*^9, 3.7554732917964153`*^9}, {
   3.7554759698891506`*^9, 3.755475972369512*^9}, 3.7554760279628396`*^9, 
   3.7554763892845926`*^9, {3.7554764200134478`*^9, 3.7554764350911207`*^9}, 
   3.7554765606871853`*^9, {3.755479090483629*^9, 3.75547909269268*^9}, 
   3.7554791304736676`*^9, {3.756548176095018*^9, 3.756548184611454*^9}, 
   3.756548275023305*^9, {3.7565483055619707`*^9, 3.756548384857662*^9}, {
   3.756548453644519*^9, 3.7565485792095804`*^9}, {3.7565486104575644`*^9, 
   3.7565486439237576`*^9}, {3.75654944383904*^9, 3.7565494645504227`*^9}, {
   3.7565737149886293`*^9, 3.756573721832269*^9}, {3.7566401586706095`*^9, 
   3.7566401805863056`*^9}, 3.7566420128900356`*^9, {3.7566439681568084`*^9, 
   3.7566439703726325`*^9}, {3.756644333757163*^9, 3.756644358910947*^9}, 
   3.7566444357675743`*^9, {3.756644835466584*^9, 3.756644847491699*^9}, {
   3.756644962837122*^9, 3.756644963269022*^9}, {3.756646711487708*^9, 
   3.7566467343196115`*^9}, {3.7566468505525675`*^9, 3.756646850792952*^9}, {
   3.756646933511187*^9, 3.756646962563255*^9}, 3.7566470093308063`*^9, {
   3.7566472960882206`*^9, 3.756647318328767*^9}, 3.7566473959059467`*^9, 
   3.7567183782594013`*^9, {3.756718505569045*^9, 3.7567185083591986`*^9}, {
   3.7567185964632297`*^9, 3.756718596805277*^9}, {3.756718771512968*^9, 
   3.756718801060959*^9}, {3.756719065680833*^9, 3.7567190929348745`*^9}, 
   3.756719250432145*^9, {3.756720371922392*^9, 3.756720372295554*^9}, 
   3.7567243172151814`*^9, 3.7567289928979263`*^9, {3.756750343647904*^9, 
   3.7567503706740365`*^9}, {3.757098426737379*^9, 3.757098426798403*^9}, {
   3.7571003926083345`*^9, 3.7571003930092745`*^9}, {3.7571602145888853`*^9, 
   3.757160214643339*^9}, {3.7572330751400385`*^9, 3.7572330836372104`*^9}, {
   3.757250531236768*^9, 3.7572505553643456`*^9}, {3.757250594525881*^9, 
   3.757250594636742*^9}, 3.757252437968197*^9, 3.7572526923501215`*^9, 
   3.7572527376825576`*^9, {3.7572528534701834`*^9, 3.7572528889986973`*^9}, 
   3.757265369199374*^9, {3.7572665359636507`*^9, 3.7572665384147954`*^9}, 
   3.75726686791994*^9, 3.757269465811569*^9, {3.7572727302613707`*^9, 
   3.7572727303761587`*^9}, {3.757362431703559*^9, 3.757362433098407*^9}, {
   3.7574026951580253`*^9, 3.757402699679463*^9}, 3.757405724121685*^9, 
   3.7574067787048073`*^9, 3.757420158713395*^9, 3.757420230323147*^9, {
   3.7575424154923897`*^9, 3.7575424157929955`*^9}, 3.7575465238257866`*^9, 
   3.7575466609901485`*^9, {3.757546790784704*^9, 3.757546798791844*^9}, 
   3.7575469103898783`*^9, {3.7575836795920863`*^9, 3.7575836815313225`*^9}, {
   3.762065528977413*^9, 3.7620655350292068`*^9}, {3.762065674058153*^9, 
   3.762065691626128*^9}, 3.7620657412694073`*^9, {3.762886534913429*^9, 
   3.7628865734413643`*^9}, {3.7628868067220774`*^9, 
   3.7628868516976275`*^9}, {3.762886883242256*^9, 3.762886890809001*^9}, {
   3.7628869971295424`*^9, 3.762886998608627*^9}, {3.76288710621029*^9, 
   3.7628871266007433`*^9}, {3.7628871927210617`*^9, 3.762887202280535*^9}, 
   3.762887980688336*^9, {3.7628881864568768`*^9, 3.762888186528683*^9}, 
   3.762888220543501*^9, 3.7628885926003475`*^9, {3.762888772649912*^9, 
   3.7628887770321875`*^9}, {3.7628976659087276`*^9, 
   3.7628976662059355`*^9}, {3.7628978420395684`*^9, 3.7628978488283644`*^9}, 
   3.76289789102652*^9, {3.7628979940201635`*^9, 3.7628980085003858`*^9}, 
   3.7628980591279554`*^9, {3.762898120278414*^9, 3.7628981436508636`*^9}, {
   3.762898185758255*^9, 3.7628981859796157`*^9}, {3.762899453950712*^9, 
   3.7628994598668528`*^9}, {3.762899542207565*^9, 3.7628995424957557`*^9}, {
   3.762899729539852*^9, 3.7628997305172353`*^9}, {3.762899881195696*^9, 
   3.7628998812615204`*^9}, {3.7628999315280943`*^9, 3.762899932759759*^9}, {
   3.762900427672534*^9, 3.762900476305684*^9}, 3.7629005179007225`*^9, {
   3.76290512135933*^9, 3.762905161791134*^9}, {3.7629058834418116`*^9, 
   3.7629058995686736`*^9}, {3.7629059833385396`*^9, 3.762905983368503*^9}, {
   3.762906020399506*^9, 3.762906071851866*^9}, {3.762906112420385*^9, 
   3.7629061128562164`*^9}, {3.7629764512022095`*^9, 
   3.7629764513927045`*^9}, {3.762976486100814*^9, 3.762976487335511*^9}, 
   3.7629766025842113`*^9, {3.7629779481666126`*^9, 3.7629779488617144`*^9}, {
   3.7629780244515457`*^9, 3.7629780686522636`*^9}, {3.76297977378434*^9, 
   3.762979773960909*^9}, {3.762979810024435*^9, 3.7629798101121607`*^9}, {
   3.7629799753888745`*^9, 3.762979977178131*^9}, 3.7629802357212715`*^9, 
   3.763030974915753*^9, {3.7630364113858733`*^9, 3.763036418620205*^9}, {
   3.763036536351858*^9, 3.7630365370542073`*^9}, {3.7634605020669622`*^9, 
   3.763460561975687*^9}, {3.7634607222336583`*^9, 3.763460840679763*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Ytraj", ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", "Thick", ",", "18"}], "]"}]}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<time (years)\>\"", ",", "\"\<Proportion infectious with i\>\""}], 
     "}"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", 
    RowBox[{"Style", "[", 
     RowBox[{
     "\"\<Cyclic/Intermittent Chaotic Strain Structure\>\"", ",", "22", ",", 
      "Black"}], "]"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<(0,0,0)\>\"", ",", "\"\<(0,0,1)\>\"", ",", "\"\<(0,1,0)\>\"", ",", 
      "\"\<(0,1,1)\>\"", ",", "\"\<(1,0,0)\>\"", ",", "\"\<(1,0,1)\>\"", ",", 
      "\"\<(1,1,0)\>\"", ",", "\"\<(1,1,1)\>\""}], "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "500"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.7629763730063496`*^9, 3.762976415483719*^9, {3.762976548524824*^9, 
   3.7629765489636664`*^9}, {3.7629766222625694`*^9, 3.7629766227473125`*^9}, 
   3.762978034185465*^9, {3.763036443834777*^9, 3.763036451093774*^9}, {
   3.7634606059137793`*^9, 3.7634606358557215`*^9}, {3.7634606955280547`*^9, 
   3.7634606964795113`*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Ztraj", ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", "Thick", ",", "18"}], "]"}]}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<time (years)\>\"", ",", "\"\<Proportion immune to i\>\""}], 
     "}"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", 
    RowBox[{"Style", "[", 
     RowBox[{
     "\"\<Cyclic/Intermittent Chaotic Strain Structure\>\"", ",", "22", ",", 
      "Black"}], "]"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<(0,0,0)\>\"", ",", "\"\<(0,0,1)\>\"", ",", "\"\<(0,1,0)\>\"", ",", 
      "\"\<(0,1,1)\>\"", ",", "\"\<(1,0,0)\>\"", ",", "\"\<(1,0,1)\>\"", ",", 
      "\"\<(1,1,0)\>\"", ",", "\"\<(1,1,1)\>\""}], "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "500"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7634606666802645`*^9, 3.7634606932870903`*^9}}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Wtraj", ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Directive", "[", 
     RowBox[{"Black", ",", "Thick", ",", "18"}], "]"}]}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<time (years)\>\"", ",", 
      "\"\<Proportion immune by strains sharing alleles with i\>\""}], 
     "}"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", 
    RowBox[{"Style", "[", 
     RowBox[{
     "\"\<Cyclic/Intermittent Chaotic Strain Structure\>\"", ",", "22", ",", 
      "Black"}], "]"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<(0,0,0)\>\"", ",", "\"\<(0,0,1)\>\"", ",", "\"\<(0,1,0)\>\"", ",", 
      "\"\<(0,1,1)\>\"", ",", "\"\<(1,0,0)\>\"", ",", "\"\<(1,0,1)\>\"", ",", 
      "\"\<(1,1,0)\>\"", ",", "\"\<(1,1,1)\>\""}], "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "500"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.76346066904095*^9, 3.763460688463998*^9}}]
},
WindowSize->{1264, 637},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 4290, 104, 266, "Input"],
Cell[4851, 126, 17138, 383, 416, "Input"],
Cell[21992, 511, 1450, 32, 69, "Input"],
Cell[23445, 545, 1157, 26, 69, "Input"],
Cell[24605, 573, 1194, 28, 69, "Input"]
}
]
*)

